{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://dpp-keystone.org/spec/validation/v1/json-schema/textile.schema.json",
  "title": "DPP for Textiles (Draft)",
  "description": "A conditional schema that applies if the DPP is for the textile sector.",
  "if": {
    "type": "object",
    "properties": {
      "contentSpecificationIds": {
        "type": "array",
        "contains": {
          "const": "draft_textile_specification_id"
        }
      }
    },
    "required": [
      "contentSpecificationIds"
    ]
  },
  "then": {
    "type": "object",
    "properties": {
      "fibreComposition": {
        "description": "The composition of the product by fibre type. Unit: Percentage by Mass (%). Standard: EU Regulation 1007/2011.",
        "type": "array",
        "minItems": 1,
        "items": {
          "type": "object",
          "properties": {
            "fibreType": {
              "type": "string"
            },
            "fibrePercentage": {
              "type": "number",
              "minimum": 0,
              "maximum": 100
            }
          },
          "required": [
            "fibreType",
            "fibrePercentage"
          ]
        }
      },
      "color": {
        "type": "string"
      },
      "apparelSize": {
        "type": "string"
      },
      "apparelSizeSystem": {
        "type": "string"
      },
      "careInstructions": {
        "description": "A sequence of standardized care symbols. Standard: ISO 3758 (GINETEX).",
        "type": "array",
        "minItems": 1,
        "items": {
          "type": "string",
          "description": "A GINETEX symbol identifier."
        }
      },
      "recycledContentPercentage": {
        "description": "The total percentage of recycled material in the product. Unit: Percentage by Mass (%).",
        "type": "number",
        "minimum": 0,
        "maximum": 100
      },
      "animalOriginNonTextile": {
        "type": "boolean"
      },
      "productionSteps": {
        "description": "The country of major production steps. Unit: ISO 3166-1 alpha-3 Country Code.",
        "type": "array",
        "minItems": 1,
        "items": {
          "type": "object",
          "properties": {
            "step": {
              "type": "string",
              "enum": [
                "Spinning",
                "Weaving",
                "Knitting",
                "Finishing",
                "Dyeing",
                "Assembly"
              ]
            },
            "countryCode": {
              "type": "string",
              "pattern": "^[A-Z]{3}$"
            }
          },
          "required": [
            "step",
            "countryCode"
          ]
        }
      },
      "substancesOfConcern": {
        "description": "A declaration of any Substances of Very High Concern (SVHC) present above 0.1% weight by weight. Standard: REACH Regulation (EC) 1907/2006.",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "substanceName": {
              "type": "string"
            },
            "casNumber": {
              "type": "string"
            },
            "concentration": {
              "type": "number",
              "minimum": 0.1
            }
          },
          "required": [
            "substanceName",
            "casNumber",
            "concentration"
          ]
        }
      },
      "tearStrength": {
        "description": "The force required to propagate a tear in the fabric. Unit: Newtons (N). Standard: ISO 13937-2.",
        "type": "object",
        "properties": {
          "value": {
            "type": "number",
            "minimum": 0
          },
          "testMethod": {
            "type": "string",
            "const": "ISO 13937-2"
          }
        },
        "required": [
          "value",
          "testMethod"
        ]
      },
      "abrasionResistance": {
        "description": "The durability of the fabric against abrasion. Unit: Number of Rubs/Cycles to breakdown. Standard: ISO 12947 series.",
        "type": "object",
        "properties": {
          "cycles": {
            "type": "integer",
            "minimum": 0
          },
          "testMethod": {
            "type": "string",
            "pattern": "^ISO 12947(-\\d+)?$"
          }
        },
        "required": [
          "cycles",
          "testMethod"
        ]
      },
      "dimensionalStability": {
        "description": "The percentage a fabric shrinks or grows after washing and drying. Unit: Dimensional Change (%). Standard: ISO 5077.",
        "type": "object",
        "properties": {
          "warpChange": {
            "type": "number"
          },
          "weftChange": {
            "type": "number"
          },
          "testMethod": {
            "type": "string",
            "const": "ISO 5077"
          }
        },
        "required": [
          "warpChange",
          "weftChange",
          "testMethod"
        ]
      },
      "colorfastnessToWashing": {
        "description": "The resistance of the color to domestic laundering. Unit: Change in Colour Grade (Scale 1-5, where 5 is best). Standard: ISO 105-C06.",
        "type": "object",
        "properties": {
          "grade": {
            "type": "number",
            "minimum": 1,
            "maximum": 5
          },
          "testMethod": {
            "type": "string",
            "const": "ISO 105-C06"
          }
        },
        "required": [
          "grade",
          "testMethod"
        ]
      },
      "microplasticRelease": {
        "description": "The amount of lint and other particles released during laundering. Unit: Milligrams per kilogram of textile (mg/kg). Standard: ISO 4484-1.",
        "type": "object",
        "properties": {
          "value": {
            "type": "number",
            "minimum": 0
          },
          "testMethod": {
            "type": "string",
            "const": "ISO 4484-1"
          }
        },
        "required": [
          "value",
          "testMethod"
        ]
      }
    },
    "required": [
      "fibreComposition",
      "color",
      "apparelSize",
      "apparelSizeSystem",
      "careInstructions",
      "recycledContentPercentage",
      "animalOriginNonTextile",
      "productionSteps"
    ]
  }
}
