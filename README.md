# DPP Harmonizing Data Dictionary (Keystone)

This repository provides a centralized, harmonized vocabulary for the EU Digital Product Passport (DPP). It contains an open-source library of JSON-LD definitions that map the semantic equivalencies between various standards (ISO, GS1, Schema.org, etc.) required for the DPP.

Our goal is to ensure interoperability and lower the barrier for implementation, especially for SMEs.

*   **Live Site & Definitions:** [https://dpp-keystone.org](https://dpp-keystone.org)
*   **GitHub Repository:** [https://github.com/dpp-keystone-org/DPPKeystoneOrg](https://github.com/dpp-keystone-org/DPPKeystoneOrg)
*   **License:** [CC0 1.0 Universal](LICENSE)

## Project Philosophy and Governance

Understanding the project's goals and processes is key to effective contribution.

*   **[Methodology](docs/methodology.md):** Explains the "Why" behind our technical approach (JSON-LD, Ontologies, etc.).
*   **[Governance Model](docs/governance.md):** Details the decision-making process for changes and the project's versioning strategy.
*   **[Contributing Guide](CONTRIBUTING.md):** Provides the "How" for submitting changes and the technical style guides.
*   **[Validation Strategy](src/validation/README.md):** A deep dive into our dual approach to data validation using JSON Schema and SHACL.

## Project Structure

This repository uses a source/build structure to separate development files from production-ready artifacts.

*   `src/`: This directory contains all the **source files** for the ontology, contexts, validation shapes, and examples. **All edits and contributions should be made here.** These files may contain comments for clarity.
*   `dist/`: This directory contains the **generated, production-ready files** that are deployed to the live site. The files in this directory are automatically generated by the build process, which strips all comments. **Do not edit files in this directory directly.**
*   `testing/`: Contains the validation and integration test suite.
*   `src/validation/`: Contains the source files for data validation, including JSON Schemas and SHACL shapes. For a detailed explanation of the project's validation strategy, please see the [Validation Strategy README](src/validation/README.md).
*   `scripts/`: Contains the build and clean scripts.

## Local Development

To work with this project locally, you will need Node.js installed.

### 1. Install Dependencies

First, install the dependencies for both the root build process and the testing suite.

```bash
# From the project root, install build dependencies
npm install

# Navigate to the testing directory and install test dependencies
cd testing
npm install
cd ..
```

### 2. Build Production Files

To generate the clean, comment-free files in the `dist/` directory, run the build command from the project root.

```bash
npm run build
```

### 3. Run Tests

To validate the data models and examples, run the test command from the project root.

```bash
npm test
```

## Build Process Details

The `npm run build` command orchestrates a series of scripts to generate the production-ready `dist` directory. Here are the key steps:

1.  **Clean and Copy:** The build process starts by deleting the existing `dist` directory. It then copies all files from the `src` directory into a `dist/spec` subdirectory.
2.  **Sanitize JSON:** All JSON and JSON-LD files are parsed to remove comments and trailing commas, ensuring they are standard, machine-readable JSON files.
3.  **Generate Spec Docs:** The `generate-spec-docs.mjs` script runs, creating human-readable HTML documentation for the ontologies and contexts. This includes generating Mermaid.js diagrams for class relationships and creating `index.html` files in the `dist/spec/ontology` and `dist/spec/contexts` directories.
4.  **Update Main Index:** Finally, the `update-index-html.mjs` script dynamically populates the main `dist/index.html` file with up-to-date links to all the generated artifacts, including contexts, ontologies, and examples.

This process transforms the development source files into a clean, well-documented, and deployable state.

## JavaScript Utilities

This repository is beginning to include a collection of JavaScript utilities designed to help developers work with DPP Keystone data. These utilities can be found in the `dist/spec/util/js` directory of the deployed site.

### EPD Adapter (`dpp-adapter.js`)

The Environmental Product Declaration (EPD) Adapter is a powerful utility for transforming the rich, semantic EPD data embedded in a DPP into a more widely recognized format.

-   **Purpose**: It processes a DPP JSON-LD document, expands the EPD indicators (like Global Warming Potential) using the Keystone ontologies, and converts each one into a `schema.org/Certification` object.
-   **Benefit**: This allows search engines and other semantic data consumers that understand schema.org to immediately interpret your product's environmental impact data as a verifiable certification, increasing data interoperability.
-   **Usage**: The library exports an `EPDAdapter` function that takes the DPP document as input and returns a promise that resolves to an array of certification objects. A corresponding test file is provided alongside the utility to demonstrate its usage.

## AI-Assisted Development

This project uses an `AI_ROADMAP.md` file in the root directory to track development tasks and maintain context for AI-assisted engineering. This file outlines completed work, current priorities, and next steps, ensuring continuity and focus across development sessions.

## Automated Build and Deployment

This project uses GitHub Actions to automate the testing and deployment process. When changes are pushed to the `main` branch, the following steps are executed automatically:

1.  **Install Dependencies:** All `npm` dependencies for the root project and the `testing` suite are installed.
2.  **Build & Test:** The `npm test` command is run, which first builds all production files in the `dist` directory and then runs a full suite of validation tests against the data models.
3.  **Deploy:** If the tests pass, the contents of the `dist` directory are automatically deployed to the `gh-pages` branch, which serves the live site at [dpp-keystone.org](https://dpp-keystone.org).

This ensures that the production version of the data dictionary is always up-to-date and has passed all validation checks.
